// ...
// ** 1. Carga el modelo y configura la c치mara (trasera) **
async function init() {
    await loadModel(); // Asegura que el modelo est칠 cargado

    // 2. Configuraci칩n de la c치mara
    try {
        // Detener el bucle anterior si existe
        if (animationFrameId) window.cancelAnimationFrame(animationFrameId);
        if (webcam && webcam.running) webcam.stop();
        document.getElementById("webcam-container").innerHTML = ''; // Limpiar contenedor
        
        // 1. Configuraci칩n de flip: FALSE para no voltear la imagen (ideal para la trasera)
        const flip = false; 
        
        // 2. CREAMOS LA WEBCAM
        webcam = new tmImage.Webcam(200, 200, flip);

        // 3. 游꿢 L칈NEA CR칈TICA: Especificar la c치mara trasera antes de la configuraci칩n
        // Esto le dice al navegador que busque la c치mara orientada al entorno (trasera)
        webcam.webcam = {
            facingMode: "environment" 
        };
        
        await webcam.setup();
        await webcam.play();
        
        document.getElementById("webcam-container").appendChild(webcam.canvas);
        document.getElementById("cam-button").disabled = true;
        
        // 4. Inicia el bucle de predicci칩n
        loop(); 
        document.getElementById("label-container").innerHTML = 'C치mara activa (trasera). 춰Enfoca la seta!';
    } catch (e) {
         // Si la c치mara trasera falla (por permisos, o el dispositivo no la soporta as칤)
         document.getElementById("label-container").innerHTML = '<span class="danger">ERROR: No se pudo iniciar la c치mara trasera. Usando la c치mara por defecto.</span>';
         console.error("Fallo al intentar forzar la c치mara trasera:", e);
         
         // Intento de fallback a la c치mara por defecto (delantera o trasera, seg칰n el navegador)
         try {
             webcam = new tmImage.Webcam(200, 200, true); // Vuelve a intentar con flip=true por defecto
             await webcam.setup();
             await webcam.play();
             document.getElementById("webcam-container").appendChild(webcam.canvas);
             loop();
         } catch (e2) {
             document.getElementById("label-container").innerHTML = '<span class="danger">ERROR: La c치mara no est치 disponible. Sube una imagen.</span>';
             document.getElementById("cam-button").disabled = true;
         }
    }
}
// ...
</body>
</html>

