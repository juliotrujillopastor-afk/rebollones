async function init() {
    await loadModel();

    try {
        // Detener cualquier cámara anterior
        if (animationFrameId) window.cancelAnimationFrame(animationFrameId);
        if (webcam && webcam.running) webcam.stop();
        document.getElementById("webcam-container").innerHTML = '';

        const flip = false; // No voltear para trasera
        webcam = new tmImage.Webcam(200, 200, flip);

        // ⚡ PASO CLAVE: Especificar la cámara trasera en setup
        await webcam.setup({ facingMode: "environment" });
        await webcam.play();

        document.getElementById("webcam-container").appendChild(webcam.canvas);
        document.getElementById("cam-button").disabled = true;

        loop();
        document.getElementById("label-container").innerHTML = 'Cámara activa (trasera). ¡Enfoca la seta!';

    } catch (e) {
        console.error("Error al iniciar cámara trasera:", e);
        document.getElementById("label-container").innerHTML = '<span class="danger">No se pudo usar la cámara trasera. Usando cámara por defecto.</span>';

        // fallback a cámara por defecto
        try {
            webcam = new tmImage.Webcam(200, 200, true);
            await webcam.setup();
            await webcam.play();
            document.getElementById("webcam-container").appendChild(webcam.canvas);
            loop();
        } catch (e2) {
            document.getElementById("label-container").innerHTML = '<span class="danger">ERROR: La cámara no está disponible.</span>';
            document.getElementById("cam-button").disabled = true;
        }
    }
}
